---
title: "SpringBoot é›†æˆé˜¿é‡Œäº‘ OSS æ–‡ä»¶ä¸Šä¼ ï¼ˆå«é…ç½®æ–‡ä»¶ï¼‰"
date: 2025-07-26 21:30:00
author: Warren Wu
tags:
  - Spring Boot
  - OSS
  - é˜¿é‡Œäº‘
  - æ–‡ä»¶ä¸Šä¼ 
  - é…ç½®æ–‡ä»¶
categories:
  - åç«¯å¼€å‘
description: æœ¬æ–‡è®²è§£å¦‚ä½•åœ¨ Spring Boot ä¸­é…ç½®å¹¶å®ç°åŸºäºé˜¿é‡Œäº‘ OSS çš„æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œæ¶µç›– application.yml/properties é…ç½®ã€AliOSS å·¥å…·ç±»ã€Controller ç¼–å†™ç­‰å®Œæ•´æµç¨‹ã€‚
---

# â˜ SpringBoot é›†æˆé˜¿é‡Œäº‘ OSS å®ç°æ–‡ä»¶ä¸Šä¼ 

åœ¨ç°ä»£åå°é¡¹ç›®å¼€å‘ä¸­ï¼Œæ–‡ä»¶ä¸Šä¼ æ˜¯éå¸¸å¸¸è§çš„åŠŸèƒ½ï¼Œè€Œå°†æ–‡ä»¶å­˜å‚¨åœ¨äº‘ç«¯å¯ä»¥æå¤§æå‡è®¿é—®é€Ÿåº¦ä¸å¯é æ€§ã€‚æœ¬æ–‡ä»¥ **é˜¿é‡Œäº‘ OSS** ä¸ºä¾‹ï¼Œç»“åˆ Spring Boot é¡¹ç›®ï¼Œå®Œæ•´å®ç°æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œå¹¶é™„å®Œæ•´é…ç½®æ–‡ä»¶ä¸ä»£ç ç¤ºä¾‹ã€‚

---

## 1ï¸âƒ£ application.properties ç¤ºä¾‹ï¼ˆå¼€å‘åˆæœŸå¿«é€Ÿæµ‹è¯•ï¼‰

```properties
# é˜¿é‡Œäº‘ OSS é…ç½®
aliyun.oss.endpoint=https://oss-cn-hangzhou.aliyuncs.com
aliyun.oss.accessKeyId=ä½ çš„AccessKeyId
aliyun.oss.accessKeySecret=ä½ çš„AccessKeySecret
aliyun.oss.bucketName=web-tlias2025726
```
## 2ï¸âƒ£ application.yml æ¨èé…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒå»ºè®®ï¼‰
```yaml
spring:
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/tlias
    username: root
    password: 123456
  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 100MB

mybatis:
  configuration:
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
    map-underscore-to-camel-case: true

aliyun:
  oss:
    endpoint: https://oss-cn-hangzhou.aliyuncs.com
    accessKeyId: ä½ çš„AccessKeyId
    accessKeySecret: ä½ çš„AccessKeySecret
    bucketName: web-tlias2025726
```
### 3ï¸âƒ£ é˜¿é‡Œäº‘ OSS å·¥å…·ç±» AliOSSUtils
```java
@Component
public class AliOSSUtils {

    @Value("${aliyun.oss.endpoint}")
    private String endpoint;

    @Value("${aliyun.oss.accessKeyId}")
    private String accessKeyId;

    @Value("${aliyun.oss.accessKeySecret}")
    private String accessKeySecret;

    @Value("${aliyun.oss.bucketName}")
    private String bucketName;

    /**
     * ä¸Šä¼ æ–‡ä»¶åˆ°é˜¿é‡Œäº‘ OSSï¼Œå¹¶è¿”å›æ–‡ä»¶è®¿é—® URL
     */
    public String upload(MultipartFile file) throws Exception {
        // è·å–ä¸Šä¼ æ–‡ä»¶çš„è¾“å…¥æµ
        InputStream inputStream = file.getInputStream();

        // è·å–åŸå§‹æ–‡ä»¶åå¹¶ç”Ÿæˆå”¯ä¸€æ–°æ–‡ä»¶å
        String originalFilename = file.getOriginalFilename();
        String fileName = UUID.randomUUID().toString() + originalFilename.substring(originalFilename.lastIndexOf("."));

        // åˆ›å»º OSS å®¢æˆ·ç«¯å®ä¾‹
        OSS ossClient = new OSSClientBuilder().build(endpoint, accessKeyId, accessKeySecret);

        // æ‰§è¡Œä¸Šä¼ 
        ossClient.putObject(bucketName, fileName, inputStream);

        // æ‹¼æ¥è®¿é—®è·¯å¾„
        String url = endpoint.replace("https://", "https://" + bucketName + ".") + "/" + fileName;

        // å…³é—­å®¢æˆ·ç«¯
        ossClient.shutdown();

        return url;
    }
}
```
## 4ï¸âƒ£ Controller æ§åˆ¶å™¨ç±»
```java
@RestController
@RequestMapping("/upload")
public class UploadController {

    @Autowired
    private AliOSSUtils aliOSSUtils;

    /**
     * ä¸Šä¼ æ–‡ä»¶æ¥å£
     */
    @PostMapping
    public Result upload(MultipartFile image) throws Exception {
        log.info("ä¸Šä¼ æ–‡ä»¶ï¼Œå‚æ•°ï¼š{}", image.getOriginalFilename());

        // è°ƒç”¨å·¥å…·ç±»ä¸Šä¼ å¹¶è·å– URL
        String url = aliOSSUtils.upload(image);

        log.info("æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼ŒURL: {}", url);
        return Result.success(url);
    }
}
```
ğŸ“Œ æ³¨æ„äº‹é¡¹
å®‰å…¨ï¼šå®é™…é¡¹ç›®ä¸­ï¼Œè¯·å°† AccessKey ä¿¡æ¯é…ç½®åœ¨ .env æ–‡ä»¶æˆ–é…ç½®ä¸­å¿ƒï¼Œé¿å…ä¸Šä¼ è‡³ GitHubã€‚

æƒé™ï¼šé˜¿é‡Œäº‘ Bucket æƒé™éœ€è®¾ç½®ä¸ºâ€œå…¬å…±è¯»â€ï¼Œå¦åˆ™å‰ç«¯å°†æ— æ³•è®¿é—®å›¾ç‰‡ã€‚

ä¾èµ–ï¼šè¯·æ·»åŠ  Aliyun OSS Java SDK ä¾èµ–ï¼š

```xml
<dependency>
    <groupId>com.aliyun.oss</groupId>
    <artifactId>aliyun-sdk-oss</artifactId>
    <version>3.15.2</version>
</dependency>
```
# ğŸ§© @ConfigurationProperties ä¸ @Value çš„åŒºåˆ«è¯¦è§£
åœ¨ Spring Boot ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å°†é…ç½®æ–‡ä»¶ï¼ˆå¦‚ application.yml æˆ– application.propertiesï¼‰ä¸­çš„é…ç½®å€¼æ³¨å…¥åˆ° Java ç±»ä¸­ï¼ŒSpring æä¾›äº†ä¸¤ç§ä¸»è¦æ–¹å¼ï¼š

@Valueï¼šé€‚åˆå•ä¸ªå±æ€§æ³¨å…¥

@ConfigurationPropertiesï¼šé€‚åˆæ‰¹é‡æ³¨å…¥å±æ€§åˆ° Java Bean
## 1ï¸âƒ£ @Value æ³¨è§£
@Value æ˜¯ Spring æä¾›çš„åŸºç¡€æ³¨è§£ï¼Œç”¨äºæ³¨å…¥å•ä¸ªé…ç½®é¡¹ï¼Œä½¿ç”¨ç®€å•ç›´æ¥ã€‚

âœ… ä½¿ç”¨ç¤ºä¾‹ï¼š
```java
@Component
public class OSSConfig {

    @Value("${aliyun.oss.endpoint}")
    private String endpoint;

    @Value("${aliyun.oss.accessKeyId}")
    private String accessKeyId;

    @Value("${aliyun.oss.accessKeySecret}")
    private String accessKeySecret;

    @Value("${aliyun.oss.bucketName}")
    private String bucketName;

    // Getter / Setter å¯é€‰
}
```
ğŸ“Œ ç‰¹ç‚¹ï¼š
é€‚åˆå°‘é‡é…ç½®é¡¹

æ¯ä¸ªå­—æ®µéƒ½éœ€è¦åŠ ä¸€æ¬¡ @Value

ä¸æ”¯æŒåµŒå¥—å¯¹è±¡çš„é…ç½®æ˜ å°„

## 2ï¸âƒ£ @ConfigurationProperties æ³¨è§£
@ConfigurationProperties å¯ä»¥å°†é…ç½®æ–‡ä»¶ä¸­çš„å±æ€§æ‰¹é‡ç»‘å®šåˆ°ä¸€ä¸ª Java Bean ä¸­ï¼Œæ”¯æŒå±‚çº§ç»“æ„ï¼Œé€‚åˆå¤§å‹é…ç½®ã€‚

âœ… ä½¿ç”¨ç¤ºä¾‹ï¼š
```java
@Component
@ConfigurationProperties(prefix = "aliyun.oss")
public class AliOSSProperties {

    private String endpoint;
    private String accessKeyId;
    private String accessKeySecret;
    private String bucketName;

    // Getter / Setter
}
```
ğŸ“Œ é…ç½®æ–‡ä»¶ç¤ºä¾‹ï¼š
```yaml
aliyun:
  oss:
    endpoint: https://oss-cn-hangzhou.aliyuncs.com
    accessKeyId: your-access-key-id
    accessKeySecret: your-access-key-secret
    bucketName: your-bucket-name
```
ğŸ“Œ ç‰¹ç‚¹ï¼š
é€‚åˆé…ç½®é¡¹è¾ƒå¤šã€ç»“æ„æ¸…æ™°çš„æƒ…å†µ

æ”¯æŒåµŒå¥—å¯¹è±¡å’Œç±»å‹è½¬æ¢

æ¨èä¸ @Component ä¸€èµ·ä½¿ç”¨ï¼Œä¹Ÿå¯é…åˆ @EnableConfigurationProperties ä½¿ç”¨

### ğŸ†š å¯¹æ¯”æ€»ç»“
| ç‰¹æ€§         | `@Value`    | `@ConfigurationProperties` |
| ---------- | ----------- | -------------------------- |
| æ˜¯å¦æ”¯æŒæ‰¹é‡æ³¨å…¥   | âŒ å¦ï¼Œåªèƒ½ä¸€é¡¹ä¸€é¡¹å†™ | âœ… æ˜¯ï¼Œæ”¯æŒæ•´ä¸ª Bean çš„ç»‘å®š          |
| æ˜¯å¦æ”¯æŒæ¾æ•£ç»‘å®š   | âŒ å¦         | âœ… æ˜¯ï¼ˆæ”¯æŒé©¼å³°ã€ä¸‹åˆ’çº¿ã€å¤§å°å†™æ··åˆç­‰ï¼‰       |
| æ˜¯å¦æ”¯æŒåµŒå¥—ç»“æ„é…ç½® | âŒ å¦         | âœ… æ˜¯                        |
| æ˜¯å¦æ”¯æŒç±»å‹å®‰å…¨æ£€æŸ¥ | âŒ å¦         | âœ… æ˜¯ï¼ˆSpring Boot æä¾›ç»‘å®šæ ¡éªŒï¼‰    |
| æ¨èåœºæ™¯       | ç®€å•é…ç½®ã€å°‘é‡å­—æ®µ   | é…ç½®ç±»å°è£…ã€ç»“æ„æ¸…æ™°ã€å¯ç»´æŠ¤æ€§å¼º           |


### ğŸ“ å°æç¤º
ä½¿ç”¨ @ConfigurationProperties æ—¶è¦ç¡®ä¿æœ‰å¯¹åº”çš„ getter / setter æ–¹æ³•ï¼Œå¦åˆ™ Spring æ— æ³•è¿›è¡Œå±æ€§ç»‘å®šã€‚

è‹¥ä½¿ç”¨ @EnableConfigurationProperties(AliOSSProperties.class)ï¼Œå¯ä»¥çœç•¥ @Component æ³¨è§£ï¼Œä½†éœ€è¦åœ¨é…ç½®ç±»ä¸ŠåŠ ã€‚
